#!/usr/bin/env bash

if [ "$#" -ne 2 ]; then
    echo "Usage: git-sort-commits <input_commit_file> <log_file>"
    exit 1
fi

INPUT_FILE="$1"
LOG_FILE="$2"
OUTPUT_FILE="${INPUT_FILE}.sorted"
TEMP_FILE=$(mktemp)

while read -r line; do
    [ -z "$line" ] && continue

    grep -n "${line:0:12}" "$LOG_FILE" >> "$TEMP_FILE"
done < "$INPUT_FILE"

sort -n -o "$TEMP_FILE" "$TEMP_FILE"

tail -n 10 "$TEMP_FILE"

head -n -10 "$TEMP_FILE" > "$OUTPUT_FILE"

rm "$TEMP_FILE"
